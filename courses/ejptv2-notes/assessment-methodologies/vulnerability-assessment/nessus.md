# Nessus

### Overview

> In this lab you will use Nessus to scan and perform vulnerability analysis of a target machine running an instance of Mutillidae web application.
>
> This exercise will help you understand how to perform vulnerability scanning using Nessus.

### Tasks

> ## Lab Environment
>
> In this lab environment, the user is going to get access to a Kali GUI instance. An instance of the Mutillidae web application can be accessed using the tools installed on Kali at [http://demo.ine.local](http://demo.ine.local).
>
> **Objective:** Perform vulnerability scan on the target machine using Nessus.

<figure><img src="https://assets.ine.com/content/pta-labs/9_nessus/0.png" alt=""><figcaption></figcaption></figure>

> ## Relevant Information:
>
> * **Username:** admin
> * **Password:** adminpasswd
>
> ## Tools
>
> The best tools for this lab are:
>
> * Nessus
> * A web browser
>
> **Please go ahead ONLY if you have COMPLETED the lab or you are stuck! Checking the solutions before actually trying the concepts and techniques you studied in the course, will dramatically reduce the benefits of a hands-on lab!**



> Perform nmap host discovery scan

<figure><img src="../../../../.gitbook/assets/image (95).png" alt=""><figcaption></figcaption></figure>

> Launch the browser and open Nessus dashboard by navigating to [https://localhost:8834/](https://localhost:8834/)

Enter credentials into login page

* **Username:** admin
* **Password:** adminpasswd

<figure><img src="../../../../.gitbook/assets/image (94).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
Make sure to use `https` infront else will redirect to **404 BAD REQUEST**.
{% endhint %}

> Scan the target machine domain name - `demo.ine.local` using Nessus.

<figure><img src="../../../../.gitbook/assets/image (96).png" alt=""><figcaption><p>analyze target</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (97).png" alt=""><figcaption><p>select target to run scan</p></figcaption></figure>

> This would start a **Basic Network Scan** by default

<figure><img src="../../../../.gitbook/assets/image (98).png" alt=""><figcaption><p>basic network scan - running</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (99).png" alt=""><figcaption><p>basic network scan - done</p></figcaption></figure>

> In this particular scan, 2 medium severity vulnerabilities were discovered. To get more details about the vulnerabilities, click on the horizontal colored bar containing the vulnerabilities of different severity and their respective counts.

<figure><img src="../../../../.gitbook/assets/image (100).png" alt=""><figcaption><p>vulnerabilities discovered</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (101).png" alt=""><figcaption><p>information of vulnerabilities</p></figcaption></figure>

The output section on the same page might show the steps or the URL to exploit or confirm the vulnerability as well.

<figure><img src="../../../../.gitbook/assets/image (102).png" alt=""><figcaption><p>vulnerabilities output section</p></figcaption></figure>

> Download the vulnerabilities report for the basic network scan.

<figure><img src="../../../../.gitbook/assets/image (103).png" alt=""><figcaption><p>export the results</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (104).png" alt=""><figcaption><p>save file</p></figcaption></figure>



<figure><img src="../../../../.gitbook/assets/image (105).png" alt=""><figcaption><p>generated report file</p></figcaption></figure>

Before we create a custom scan, let's see the results of another scan that's shown in bold.

{% hint style="info" %}
**Information:** When start Nessus, it performs 2 basic scans by default. For one of the scans, already saw the results. The results for the second scan were not yet explored. That's why they are still in bold, which mean it still unread yet.
{% endhint %}

<figure><img src="../../../../.gitbook/assets/image (106).png" alt=""><figcaption><p>unread result</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (107).png" alt=""><figcaption><p>simple host discovery scan</p></figcaption></figure>

> Performing a custom scan using Nessus.

For the sake of this lab, since thre's **Mutillidae** running on the target machine, the obvious scan template should be **Web Application Tests**. But instead of going with this pre-available template, will create a custom vulnerability scanning template using the **Advanced Scan** template.

<figure><img src="../../../../.gitbook/assets/image (108).png" alt=""><figcaption><p>scan templates</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (109).png" alt=""><figcaption><p>advance scan selected</p></figcaption></figure>

{% hint style="info" %}
Configuration before save
{% endhint %}

Uncheck the first option (`which would test our local host for vulnerability scanning`) and will check the second option, (`which would make our scans more faster by trading-off accuracy`).

> Going with these options should be okay for simple scenario and the options might require would depend on the target/scenario have. For instance, while scanning the local machine for any vulnerabilities, you would want to keep the first option checked. And if you wish to have reliability and reduce the false positives in your scans, then second option must be checked as well!

<figure><img src="../../../../.gitbook/assets/image (111).png" alt=""><figcaption><p>Host Discovery - check 2nd option</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (112).png" alt=""><figcaption><p>Port Scanning - check TCP option</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (113).png" alt=""><figcaption><p>Assessment (General) - check "Perform thorough tests"</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (114).png" alt=""><figcaption><p>enable "Scan web applications"</p></figcaption></figure>

> Launch advanced scan

<figure><img src="../../../../.gitbook/assets/image (110).png" alt=""><figcaption><p>list of scan</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (115).png" alt=""><figcaption><p>advance scan complete</p></figcaption></figure>

Here we can see the different vulnerabilities, categorized by their severity as well the scan status and the timing details (when the scan got started, when it ended \[if it ended], and the time elapsed \[again, it's shown once the scan ends]).

<figure><img src="../../../../.gitbook/assets/image (116).png" alt=""><figcaption><p>advanced scan vulnerabilities</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (121).png" alt=""><figcaption><p>MIXED - <strong>Phpmyadmin (Multiple Issues)</strong></p></figcaption></figure>

Navigate to output URL - [http://demo.ine.local/phpmyadmin/](http://demo.ine.local/phpmyadmin/)

<figure><img src="../../../../.gitbook/assets/image (119).png" alt=""><figcaption><p>navigate to sepcified output URL</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (120).png" alt=""><figcaption><p>multidae tables</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (122).png" alt=""><figcaption><p>another vulnerabilities</p></figcaption></figure>

Navigate to output URL - [http://demo.ine.local/.git/](http://demo.ine.local/.git/)

<figure><img src="../../../../.gitbook/assets/image (123).png" alt=""><figcaption><p>Index of ./git</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (124).png" alt=""><figcaption><p>save the report in .html file format</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (125).png" alt=""><figcaption><p>.html report generated</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (126).png" alt=""><figcaption><p>check vulnerabilities of scan information</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (127).png" alt=""><figcaption><p>check another vulnerabilities of scan information</p></figcaption></figure>

<figure><img src="../../../../.gitbook/assets/image (128).png" alt=""><figcaption><p>output of vulnerabilities "Browsable Web Directories"</p></figcaption></figure>



